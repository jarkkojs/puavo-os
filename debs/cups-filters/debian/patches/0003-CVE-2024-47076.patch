commit 95576ec3d20c109332d14672a807353cdc551018
Author: Zdenek Dohnal <zdohnal@redhat.com>
Date:   Thu Sep 26 23:09:29 2024 +0200

    cfGetPrinterAttributes5(): Validate response attributes before return
    
    The destination can be corrupted or forged, so validate the response
    to strenghten security measures.
    
    Fixes CVE-2024-47076

Index: cups-filters-1.28.7/cupsfilters/ipp.c
===================================================================
--- cups-filters-1.28.7.orig/cupsfilters/ipp.c	2024-09-28 00:13:23.359418458 +0200
+++ cups-filters-1.28.7/cupsfilters/ipp.c	2024-09-28 00:14:24.139428559 +0200
@@ -378,6 +378,14 @@
 	ippDelete(response);
       } else {
 	/* Suitable response, we are done */
+
+        // Check if the response is valid
+        if (!ippValidateAttributes(response))
+        {
+          ippDelete(response);
+          response = NULL;
+        }
+
 	if (have_http == 0) httpClose(http_printer);
 	if (uri) free(uri);
 	return response;
